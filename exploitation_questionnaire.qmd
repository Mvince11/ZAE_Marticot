---
title: ""
format:
  dashboard:
    orientation: rows
editor: visual
expandable: true
layout: "grid"
scrolling: true
---

```{r setup, include=FALSE}
# Chargement des packages
library(tidyverse)
library(readr)

# Lecture du fichier CSV
donnees <- read_csv("data/results-survey337264.csv", show_col_types = FALSE)%>%
  drop_na(`Date de soumission`)
```

<h1 style="font-size:1.4em;">Partie état civil</h1>
<div style="text-align:center; font-size:1.2em; font-weight:bold; margin:10px 0;">
Voici quelques statistiques issues du questionnaire
</div>

## Row { height="40%"}

```{r}
#| echo: false

donnees %>%
  count(`Quel est votre genre ?  Veuillez cocher une case`) %>%
  ggplot(aes(x = reorder(`Quel est votre genre ?  Veuillez cocher une case`, n), y = n, fill = `Quel est votre genre ?  Veuillez cocher une case`)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(title = "Répartition des réponses par genre", x = "Genre", y = "Nombre de réponses") +
  theme(plot.title = element_text(color = "red", size = 14, face = "bold", hjust = 0.5))
```

```{r}
#| echo: false

donnees %>%
  count(`Quel est votre âge ?`) %>%
  ggplot(aes(x = `Quel est votre âge ?`, y = n, fill = `Quel est votre âge ?`)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(
    title = "Répartition des réponses par âge",
    x = "Âge",
    y = "Nombre de réponses"
  ) +
  theme(
    plot.title = element_text(color = "red", size = 14, face = "bold", hjust = 0.5)
  )
```

## Row {height="40%"}

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig.width: 5
#| fig.height: 2
donnees_age_genre <- donnees %>%
  rename(Genre = `Quel est votre genre ?  Veuillez cocher une case`) %>%
  count(`Quel est votre âge ?`, Genre)

# Étape 2 : faire le graphique
ggplot(donnees_age_genre, aes(x = `Quel est votre âge ?`, y = n, fill = Genre)) +
  geom_col(position = "dodge") +
  labs(
    title = "Répartition des réponses par âge et par genre",
    y = "Nombre de réponses",
    x = "Âge"
  ) +
  theme(
    plot.title = element_text(color = "red", size = 5, face = "bold", hjust = 0.5),
    axis.title.x = element_text(size = 6),  # Titre axe X
    axis.title.y = element_text(size = 6),  # Titre axe Y
    axis.text.x = element_text(size = 5),    # Valeurs axe X
    axis.text.y = element_text(size = 5),     # Valeurs axe Y
    legend.text = element_text(size = 4),        # Taille du texte de la légende
    legend.title = element_text(size = 5)        # Taille du titre de la légende
  )
```

## Row {height="30%"}

```{r}
#| echo: false
#| fig.width: 5
#| fig.height: 2

donnees %>%
  count(`Quelle est votre catégorie socio-professionnelle ?`) %>%
  ggplot(aes(x = reorder(`Quelle est votre catégorie socio-professionnelle ?`, n), y = n, fill = `Quelle est votre catégorie socio-professionnelle ?`)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(title = "Répartition des réponses par catégorie socio-professionnelle", x = "catégorie socio-professionnelle", y = "Nombre de réponses") +
  theme(
    plot.title = element_text(color = "red", size = 5, face = "bold", hjust = 0.5),
    axis.title.x = element_text(size = 6),  # Titre axe X
    axis.title.y = element_text(size = 6),  # Titre axe Y
    axis.text.x = element_text(size = 5),    # Valeurs axe X
    axis.text.y = element_text(size = 5),     # Valeurs axe Y
    legend.text = element_text(size = 4),        # Taille du texte de la légende
    legend.title = element_text(size = 5)        # Taille du titre de la légende
  )
```

```{r}
#| echo: false
#| fig.width: 5
#| fig.height: 2

donnees %>%
  drop_na(`Quelle est votre catégorie socio-professionnelle ? [Autre]`)%>%
  count(`Quelle est votre catégorie socio-professionnelle ? [Autre]`) %>%
  ggplot(aes(x = reorder(`Quelle est votre catégorie socio-professionnelle ? [Autre]`, n), y = n, fill = `Quelle est votre catégorie socio-professionnelle ? [Autre]`)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(title = "Répartition des réponses par catégorie socio-professionnelle", x = "catégorie socio-professionnelle", y = "Nombre de réponses") +
  theme(
    plot.title = element_text(color = "red", size = 5, face = "bold", hjust = 0.5),
    axis.title.x = element_text(size = 6),  # Titre axe X
    axis.title.y = element_text(size = 6),  # Titre axe Y
    axis.text.x = element_text(size = 5),    # Valeurs axe X
    axis.text.y = element_text(size = 5),     # Valeurs axe Y
    legend.text = element_text(size = 4),        # Taille du texte de la légende
    legend.title = element_text(size = 5)        # Taille du titre de la légende
  )
```
